<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; Documentation by YARD 0.9.16
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "README";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'>
<h1 id="label-FastForward">FastForward</h1>

<p><em>A lightweight Ruby gem for fast predictions with neural networks</em></p>

<p>The purpose of this package is to provide a lightweight, pure Ruby (but
fast!) implementation to make predictions with neural networks. This means:</p>
<ul><li>
<p>Simple ways to import a neural network trained in another language, from
JSON or <a href="http://dmg.org/pmml/pmml-v4-3.html">PMML</a> files. Note
that this package does not support training models.</p>
</li><li>
<p>Predictions are <em>fast</em> since the implementation relies on <a
href="https://github.com/SciRuby/nmatrix">NMatrix</a> and matrix-vector
multiplication.</p>
</li></ul>

<h2 id="label-Installation">Installation</h2>

<p>Add this line to your application&#39;s Gemfile:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>fast_forward</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbol'>:git</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>git://github.com/sds-dubois/fast_forward.git</span><span class='tstring_end'>&quot;</span></span>
</code></pre>

<h2 id="label-Usage">Usage</h2>

<p><a href="https://sds-dubois.github.io/fast_forward/index.html">Online
documentation</a></p>

<h3 id="label-Load+from+a+JSON+file">Load from a JSON file</h3>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>fast_forward</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>examples/data/mlp_relu_regressor.json</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_nn'>nn</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="FastForward.html" title="FastForward (module)">FastForward</a></span></span><span class='period'>.</span><span class='id identifier rubyid_load_json'><span class='object_link'><a href="FastForward.html#load_json-class_method" title="FastForward.load_json (method)">load_json</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span>

<span class='id identifier rubyid_inputs'>inputs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='lbracket'>[</span><span class='float'>0.14</span><span class='comma'>,</span> <span class='float'>0.1</span><span class='comma'>,</span> <span class='float'>1.4</span><span class='comma'>,</span> <span class='float'>0.44</span><span class='comma'>,</span> <span class='float'>0.76</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='float'>0.18</span><span class='comma'>,</span> <span class='op'>-</span><span class='float'>0.3</span><span class='comma'>,</span> <span class='float'>0.52</span><span class='comma'>,</span> <span class='float'>0.09</span><span class='comma'>,</span> <span class='float'>0.08</span><span class='rbracket'>]</span><span class='rbracket'>]</span>
<span class='id identifier rubyid_nn'>nn</span><span class='period'>.</span><span class='id identifier rubyid_predict'>predict</span><span class='lparen'>(</span><span class='id identifier rubyid_inputs'>inputs</span><span class='rparen'>)</span>
<span class='comment'># =&gt; [174.49829607413798, 67.8113924823969]
</span><span class='id identifier rubyid_nn'>nn</span><span class='period'>.</span><span class='id identifier rubyid_predict'>predict</span><span class='lparen'>(</span><span class='id identifier rubyid_inputs'>inputs</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='rparen'>)</span>
<span class='comment'># =&gt; 174.49829607413798
</span></code></pre>

<h3 id="label-Load+from+a+PMML+file">Load from a PMML file</h3>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>fast_forward</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_filename'>filename</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>examples/data/keras_tanh_classifier</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_filename'>filename</span><span class='embexpr_end'>}</span><span class='tstring_content'>.pmml</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_sample_data'>sample_data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="FastForward.html" title="FastForward (module)">FastForward</a></span></span><span class='period'>.</span><span class='id identifier rubyid_load_sample_data'><span class='object_link'><a href="FastForward.html#load_sample_data-class_method" title="FastForward.load_sample_data (method)">load_sample_data</a></span></span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_filename'>filename</span><span class='embexpr_end'>}</span><span class='tstring_content'>.json</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='id identifier rubyid_nn'>nn</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="FastForward.html" title="FastForward (module)">FastForward</a></span></span><span class='period'>.</span><span class='id identifier rubyid_load_pmml'><span class='object_link'><a href="FastForward.html#load_pmml-class_method" title="FastForward.load_pmml (method)">load_pmml</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span>
<span class='id identifier rubyid_nn'>nn</span><span class='period'>.</span><span class='id identifier rubyid_check_model_integrity'>check_model_integrity</span><span class='lparen'>(</span><span class='id identifier rubyid_sample_data'>sample_data</span><span class='comma'>,</span> <span class='label'>tol:</span> <span class='float'>1e-8</span><span class='rparen'>)</span>
<span class='comment'># =&gt; true
</span>
<span class='id identifier rubyid_inputs'>inputs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='lbracket'>[</span><span class='float'>1.01</span><span class='comma'>,</span> <span class='float'>2.35</span><span class='comma'>,</span> <span class='op'>-</span><span class='float'>2.76</span><span class='comma'>,</span> <span class='op'>-</span><span class='float'>1.08</span><span class='comma'>,</span> <span class='op'>-</span><span class='float'>0.46</span><span class='rbracket'>]</span><span class='rbracket'>]</span>
<span class='id identifier rubyid_nn'>nn</span><span class='period'>.</span><span class='id identifier rubyid_predict_proba'>predict_proba</span><span class='lparen'>(</span><span class='id identifier rubyid_inputs'>inputs</span><span class='rparen'>)</span>
<span class='comment'># =&gt; [0.8352501258487187, 0.13632516324287638, 0.02842471090840499]
</span><span class='id identifier rubyid_nn'>nn</span><span class='period'>.</span><span class='id identifier rubyid_predict_class'>predict_class</span><span class='lparen'>(</span><span class='id identifier rubyid_inputs'>inputs</span><span class='rparen'>)</span>
<span class='comment'># =&gt; 0
</span><span class='id identifier rubyid_nn'>nn</span><span class='period'>.</span><span class='id identifier rubyid_predict'>predict</span><span class='lparen'>(</span><span class='id identifier rubyid_inputs'>inputs</span><span class='rparen'>)</span>
<span class='comment'># =&gt; 0
</span></code></pre>

<p>It is highly recommended to check model integrity to make sure it correctly
matches the model trained in a different language. One way to do that is by
providing sample data (inputs/outputs) from the original model exported,
and verify in Ruby that outputs are identical.<br> Note that when exporting
in PMML format, that means you need to export the sample data in a
different file, in JSON. See the <a
href="examples/export_py_models.py">example</a> for more details.</p>

<h3 id="label-Export+Keras+and+scikit-learn+models">Export Keras and scikit-learn models</h3>

<p>Check the <a href="examples/export_py_models.py">Python example</a> for
ways to export models in a compatible format.</p>
<ul><li>
<p>You can export Keras models with <a
href="https://github.com/sds-dubois/keras2pmml">keras2pmml</a> (currently
supports feed-forward models with fully connected layers).<br> <a
href="examples/data/keras_relu_regressor.pmml">Here</a> is an example.</p>
</li><li>
<p>scikit-learn&#39;s <code>MLP</code> interface for neural networks is
straightforward and easy to export in JSON (see the example for detailed
code). Be sure to repeat the activation function for each layer and to add
the output layer activation (linear for regression / sigmoid or softmax for
classification).<br> <a
href="examples/data/mlp_relu_regressor.json">Here</a> is an example.</p>
</li></ul>

<h2 id="label-Support">Support</h2>

<h3 id="label-Models">Models</h3>
<ul><li>
<p>Regression and classification (multi-class and multi-task)</p>
</li><li>
<p>Feed-forward with fully connected layers</p>
</li><li>
<p>Activation functions:</p>
<ul><li>
<p>identity (linear)</p>
</li><li>
<p>relu (rectifier)</p>
</li><li>
<p>sigmoid (logistic)</p>
</li><li>
<p>tanh</p>
</li><li>
<p>softmax</p>
</li></ul>
</li></ul>

<h3 id="label-Data+import">Data import</h3>
<ul><li>
<p>Ruby hash</p>
</li><li>
<p><a href="http://dmg.org/pmml/v4-3/NeuralNetwork.html">PMML</a></p>
</li><li>
<p>JSON, with the following structure:</p>

<pre class="code ruby"><code class="ruby">data = {
    &quot;weights&quot;: {
        &quot;0&quot;: weights_array_0,
        &quot;1&quot;: weights_array_1,
        ...
    },
    &quot;biases&quot;:
        &quot;0&quot;: biases_array_0,
        &quot;1&quot;: biases_array_1,
        ...
    },
    &quot;activations&quot;:
        &quot;0&quot;: activation_fct_0,
        &quot;1&quot;: activation_fct_1,
        ...
    },
    &quot;samples&quot;: (optional) {
        &quot;X&quot;: sample_inputs_array,
        &quot;y&quot;: sample_outputs_array
    }
}</code></pre>
</li></ul>

<h2 id="label-License">License</h2>

<p><a href="LICENSE.md">MIT License</a></p>
</div></div>

      <div id="footer">
  Generated on Sat Oct 20 12:03:43 2018 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.16 (ruby-2.3.4).
</div>

    </div>
  </body>
</html>