<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: FastForward::NN
  
    &mdash; Documentation by YARD 0.9.16
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "FastForward::NN";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (N)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../FastForward.html" title="FastForward (module)">FastForward</a></span></span>
     &raquo; 
    <span class="title">NN</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: FastForward::NN
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">FastForward::NN</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/fast_forward/nn.rb</dd>
  </dl>
  
</div>





  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#biases-instance_method" title="#biases (instance method)">#<strong>biases</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute biases.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#input_dim-instance_method" title="#input_dim (instance method)">#<strong>input_dim</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute input_dim.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#layer_activations-instance_method" title="#layer_activations (instance method)">#<strong>layer_activations</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute layer_activations.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#layer_sizes-instance_method" title="#layer_sizes (instance method)">#<strong>layer_sizes</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute layer_sizes.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#output_dim-instance_method" title="#output_dim (instance method)">#<strong>output_dim</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute output_dim.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#weights-instance_method" title="#weights (instance method)">#<strong>weights</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute weights.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#activate-class_method" title="activate (class method)">.<strong>activate</strong>(x, activation_fct)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Activation functions.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#relu-class_method" title="relu (class method)">.<strong>relu</strong>(x)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>ReLU activation function.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#sigmoid-class_method" title="sigmoid (class method)">.<strong>sigmoid</strong>(x)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Sigmoid / logistic activation function.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#softmax-class_method" title="softmax (class method)">.<strong>softmax</strong>(x, subtract_max = true)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Softmax activation function.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#tanh-class_method" title="tanh (class method)">.<strong>tanh</strong>(x)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Tanh activation function.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#check_model_integrity-instance_method" title="#check_model_integrity (instance method)">#<strong>check_model_integrity</strong>(sample_data, tol: FastForward::DEFAULT_TOL, exception_if_fail: false, verbose: false)  &#x21d2; true, false </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The check verdict.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#forward_pass-instance_method" title="#forward_pass (instance method)">#<strong>forward_pass</strong>(inputs, array_output = true)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Neural network forward pass.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(layer_sizes, layer_activations, weights, biases)  &#x21d2; NN </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of NN.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#predict-instance_method" title="#predict (instance method)">#<strong>predict</strong>(inputs, array_output = true)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Predict outputs with a forward pass.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#predict_class-instance_method" title="#predict_class (instance method)">#<strong>predict_class</strong>(inputs)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Predict class labels with a forward pass (supports multi-class and
multi-task).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#predict_proba-instance_method" title="#predict_proba (instance method)">#<strong>predict_proba</strong>(inputs, array_output = true)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Predict class probabilities with a forward pass.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(layer_sizes, layer_activations, weights, biases)  &#x21d2; <tt><span class='object_link'><a href="" title="FastForward::NN (class)">NN</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of NN</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fast_forward/nn.rb', line 7</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_layer_sizes'>layer_sizes</span><span class='comma'>,</span> <span class='id identifier rubyid_layer_activations'>layer_activations</span><span class='comma'>,</span> <span class='id identifier rubyid_weights'>weights</span><span class='comma'>,</span> <span class='id identifier rubyid_biases'>biases</span><span class='rparen'>)</span>
    <span class='comment'># layer_sizes must include input_dim and output_dim
</span>    <span class='ivar'>@input_dim</span> <span class='op'>=</span> <span class='id identifier rubyid_layer_sizes'>layer_sizes</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='ivar'>@output_dim</span> <span class='op'>=</span> <span class='id identifier rubyid_layer_sizes'>layer_sizes</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
    <span class='ivar'>@layer_sizes</span> <span class='op'>=</span> <span class='id identifier rubyid_layer_sizes'>layer_sizes</span>
    <span class='ivar'>@layer_activations</span> <span class='op'>=</span> <span class='id identifier rubyid_layer_activations'>layer_activations</span>            

    <span class='ivar'>@n_layers</span> <span class='op'>=</span> <span class='ivar'>@layer_sizes</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='op'>-</span> <span class='int'>1</span>
    <span class='ivar'>@weights</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='ivar'>@biases</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='ivar'>@n_layers</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_idx'>idx</span><span class='op'>|</span>
        <span class='id identifier rubyid_shape'>shape</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='ivar'>@layer_sizes</span><span class='lbracket'>[</span><span class='id identifier rubyid_idx'>idx</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='ivar'>@layer_sizes</span><span class='lbracket'>[</span><span class='id identifier rubyid_idx'>idx</span> <span class='op'>+</span> <span class='int'>1</span><span class='rbracket'>]</span><span class='rbracket'>]</span>
        <span class='ivar'>@weights</span> <span class='op'>&lt;&lt;</span> <span class='const'>NMatrix</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_shape'>shape</span><span class='comma'>,</span> <span class='id identifier rubyid_weights'>weights</span><span class='lbracket'>[</span><span class='id identifier rubyid_idx'>idx</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='comma'>,</span> <span class='label'>dtype:</span> <span class='symbol'>:float64</span><span class='rparen'>)</span>
        <span class='ivar'>@biases</span> <span class='op'>&lt;&lt;</span> <span class='const'>NMatrix</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='int'>1</span><span class='comma'>,</span> <span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_biases'>biases</span><span class='lbracket'>[</span><span class='id identifier rubyid_idx'>idx</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>dtype:</span> <span class='symbol'>:float64</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="biases-instance_method">
  
    #<strong>biases</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute biases</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5
6
7</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fast_forward/nn.rb', line 5</span>

<span class='kw'>def</span> <span class='id identifier rubyid_biases'>biases</span>
  <span class='ivar'>@biases</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="input_dim-instance_method">
  
    #<strong>input_dim</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute input_dim</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5
6
7</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fast_forward/nn.rb', line 5</span>

<span class='kw'>def</span> <span class='id identifier rubyid_input_dim'>input_dim</span>
  <span class='ivar'>@input_dim</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="layer_activations-instance_method">
  
    #<strong>layer_activations</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute layer_activations</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5
6
7</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fast_forward/nn.rb', line 5</span>

<span class='kw'>def</span> <span class='id identifier rubyid_layer_activations'>layer_activations</span>
  <span class='ivar'>@layer_activations</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="layer_sizes-instance_method">
  
    #<strong>layer_sizes</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute layer_sizes</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5
6
7</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fast_forward/nn.rb', line 5</span>

<span class='kw'>def</span> <span class='id identifier rubyid_layer_sizes'>layer_sizes</span>
  <span class='ivar'>@layer_sizes</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="output_dim-instance_method">
  
    #<strong>output_dim</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute output_dim</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5
6
7</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fast_forward/nn.rb', line 5</span>

<span class='kw'>def</span> <span class='id identifier rubyid_output_dim'>output_dim</span>
  <span class='ivar'>@output_dim</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="weights-instance_method">
  
    #<strong>weights</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute weights</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5
6
7</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fast_forward/nn.rb', line 5</span>

<span class='kw'>def</span> <span class='id identifier rubyid_weights'>weights</span>
  <span class='ivar'>@weights</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="activate-class_method">
  
    .<strong>activate</strong>(x, activation_fct)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Activation functions</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


144
145
146
147
148
149
150
151
152
153
154
155
156
157
158</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fast_forward/nn.rb', line 144</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activate'>activate</span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_activation_fct'>activation_fct</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_activation_fct'>activation_fct</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>identity</span><span class='tstring_end'>&quot;</span></span> <span class='op'>||</span> <span class='id identifier rubyid_activation_fct'>activation_fct</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>linear</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>return</span> <span class='id identifier rubyid_x'>x</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_activation_fct'>activation_fct</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>relu</span><span class='tstring_end'>&quot;</span></span> <span class='op'>||</span> <span class='id identifier rubyid_activation_fct'>activation_fct</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rectifier</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="" title="FastForward::NN (class)">NN</a></span></span><span class='period'>.</span><span class='id identifier rubyid_relu'><span class='object_link'><a href="#relu-class_method" title="FastForward::NN.relu (method)">relu</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='rparen'>)</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_activation_fct'>activation_fct</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sigmoid</span><span class='tstring_end'>&quot;</span></span> <span class='op'>||</span> <span class='id identifier rubyid_activation_fct'>activation_fct</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>logistic</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="" title="FastForward::NN (class)">NN</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sigmoid'><span class='object_link'><a href="#sigmoid-class_method" title="FastForward::NN.sigmoid (method)">sigmoid</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='rparen'>)</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_activation_fct'>activation_fct</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>tanh</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="" title="FastForward::NN (class)">NN</a></span></span><span class='period'>.</span><span class='id identifier rubyid_tanh'><span class='object_link'><a href="#tanh-class_method" title="FastForward::NN.tanh (method)">tanh</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='rparen'>)</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_activation_fct'>activation_fct</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>softmax</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="" title="FastForward::NN (class)">NN</a></span></span><span class='period'>.</span><span class='id identifier rubyid_softmax'><span class='object_link'><a href="#softmax-class_method" title="FastForward::NN.softmax (method)">softmax</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Activation function not supported: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_activation_fct'>activation_fct</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="relu-class_method">
  
    .<strong>relu</strong>(x)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>ReLU activation function</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


162
163
164
165</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fast_forward/nn.rb', line 162</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_relu'>relu</span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_map!'>map!</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_e'>e</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span> <span class='rbrace'>}</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_x'>x</span> 
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="sigmoid-class_method">
  
    .<strong>sigmoid</strong>(x)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Sigmoid / logistic activation function</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


168
169
170
171</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fast_forward/nn.rb', line 168</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_sigmoid'>sigmoid</span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_map!'>map!</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='float'>1.0</span> <span class='op'>/</span> <span class='lparen'>(</span><span class='float'>1.0</span> <span class='op'>+</span> <span class='const'>Math</span><span class='op'>::</span><span class='id identifier rubyid_exp'>exp</span><span class='lparen'>(</span><span class='op'>-</span><span class='id identifier rubyid_e'>e</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_x'>x</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="softmax-class_method">
  
    .<strong>softmax</strong>(x, subtract_max = true)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Softmax activation function</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


180
181
182
183
184
185
186
187
188
189
190
191
192</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fast_forward/nn.rb', line 180</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_softmax'>softmax</span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_subtract_max'>subtract_max</span> <span class='op'>=</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_subtract_max'>subtract_max</span>
        <span class='comment'># better for numerical stability
</span>        <span class='comment'># matrix with same shape as x, with max entry per row
</span>        <span class='id identifier rubyid_row_max'>row_max</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="FastForward::NN (class)">NN</a></span></span><span class='period'>.</span><span class='id identifier rubyid_extend_vec'>extend_vec</span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_cols'>cols</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_x'>x</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span> <span class='op'>-</span> <span class='id identifier rubyid_row_max'>row_max</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_e_x'>e_x</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_exp'>exp</span>
    <span class='id identifier rubyid_row_sum'>row_sum</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="FastForward::NN (class)">NN</a></span></span><span class='period'>.</span><span class='id identifier rubyid_extend_vec'>extend_vec</span><span class='lparen'>(</span><span class='id identifier rubyid_e_x'>e_x</span><span class='period'>.</span><span class='id identifier rubyid_sum'>sum</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_e_x'>e_x</span><span class='period'>.</span><span class='id identifier rubyid_cols'>cols</span><span class='rparen'>)</span>

    <span class='kw'>return</span> <span class='id identifier rubyid_e_x'>e_x</span> <span class='op'>/</span> <span class='id identifier rubyid_row_sum'>row_sum</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="tanh-class_method">
  
    .<strong>tanh</strong>(x)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Tanh activation function</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


174
175
176
177</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fast_forward/nn.rb', line 174</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_tanh'>tanh</span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_map!'>map!</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='const'>Math</span><span class='op'>::</span><span class='id identifier rubyid_tanh'>tanh</span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_x'>x</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="check_model_integrity-instance_method">
  
    #<strong>check_model_integrity</strong>(sample_data, tol: FastForward::DEFAULT_TOL, exception_if_fail: false, verbose: false)  &#x21d2; <tt>true</tt>, <tt>false</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>sample_data is supposed to have the following structure: sample_data = {
	“samples”: { 	“X”: sample_inputs_array, 	“y”: sample_outputs_array 	} }</p>
</div>
  </div>


<p>Returns The check verdict</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>exception_if_fail</span>
      
      
        <span class='type'>(<tt>true</tt>, <tt>false</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>(Default: false) If true, raises an exception if integrity check
doesn&#39;t meet the required tolerance</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>verbose</span>
      
      
        <span class='type'>(<tt>true</tt>, <tt>false</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>(Default: false)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>true</tt>, <tt>false</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The check verdict</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


39
40
41</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fast_forward/nn.rb', line 39</span>

<span class='kw'>def</span> <span class='id identifier rubyid_check_model_integrity'>check_model_integrity</span><span class='lparen'>(</span><span class='id identifier rubyid_sample_data'>sample_data</span><span class='comma'>,</span> <span class='label'>tol:</span> <span class='const'><span class='object_link'><a href="../FastForward.html" title="FastForward (module)">FastForward</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../FastForward.html#DEFAULT_TOL-constant" title="FastForward::DEFAULT_TOL (constant)">DEFAULT_TOL</a></span></span><span class='comma'>,</span> <span class='label'>exception_if_fail:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>verbose:</span> <span class='kw'>false</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="../FastForward.html" title="FastForward (module)">FastForward</a></span></span><span class='period'>.</span><span class='id identifier rubyid_check_model_integrity'>check_model_integrity</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_sample_data'>sample_data</span><span class='comma'>,</span> <span class='label'>tol:</span> <span class='id identifier rubyid_tol'>tol</span><span class='comma'>,</span> <span class='label'>exception_if_fail:</span> <span class='id identifier rubyid_exception_if_fail'>exception_if_fail</span><span class='comma'>,</span> <span class='label'>verbose:</span> <span class='id identifier rubyid_verbose'>verbose</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="forward_pass-instance_method">
  
    #<strong>forward_pass</strong>(inputs, array_output = true)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Neural network forward pass</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>inputs</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Array of input data</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>array_output</span>
      
      
        <span class='type'>(<tt>true</tt>, <tt>false</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>(Default: true) If true, convert the output to a numerical array. Otherwise
the output will be an NMatrix object</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>Network predictions</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fast_forward/nn.rb', line 51</span>

<span class='kw'>def</span> <span class='id identifier rubyid_forward_pass'>forward_pass</span><span class='lparen'>(</span><span class='id identifier rubyid_inputs'>inputs</span><span class='comma'>,</span> <span class='id identifier rubyid_array_output'>array_output</span> <span class='op'>=</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='comment'># fix input shape if only one element is provided
</span>    <span class='id identifier rubyid_inputs'>inputs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_inputs'>inputs</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_inputs'>inputs</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Numeric</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_ones'>ones</span> <span class='op'>=</span> <span class='const'>NVector</span><span class='period'>.</span><span class='id identifier rubyid_ones'>ones</span><span class='lparen'>(</span><span class='id identifier rubyid_inputs'>inputs</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_x'>x</span> <span class='op'>=</span> <span class='const'>NMatrix</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id identifier rubyid_inputs'>inputs</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='comma'>,</span> <span class='ivar'>@input_dim</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_inputs'>inputs</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='comma'>,</span> <span class='label'>dtype:</span> <span class='symbol'>:float64</span><span class='rparen'>)</span>
    <span class='ivar'>@n_layers</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_idx'>idx</span><span class='op'>|</span>
        <span class='id identifier rubyid_h'>h</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_dot'>dot</span><span class='lparen'>(</span><span class='ivar'>@weights</span><span class='lbracket'>[</span><span class='id identifier rubyid_idx'>idx</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='id identifier rubyid_ones'>ones</span><span class='period'>.</span><span class='id identifier rubyid_dot'>dot</span><span class='lparen'>(</span><span class='ivar'>@biases</span><span class='lbracket'>[</span><span class='id identifier rubyid_idx'>idx</span><span class='rbracket'>]</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_x'>x</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="FastForward::NN (class)">NN</a></span></span><span class='period'>.</span><span class='id identifier rubyid_activate'><span class='object_link'><a href="#activate-class_method" title="FastForward::NN.activate (method)">activate</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='ivar'>@layer_activations</span><span class='lbracket'>[</span><span class='id identifier rubyid_idx'>idx</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_array_output'>array_output</span>
        <span class='kw'>return</span> <span class='id identifier rubyid_x'>x</span>
    <span class='comment'># elsif x.shape.first == 1
</span>    <span class='comment'>#     return x.first
</span>    <span class='kw'>elsif</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span> <span class='op'>==</span> <span class='lbracket'>[</span><span class='int'>1</span><span class='comma'>,</span> <span class='int'>1</span><span class='rbracket'>]</span>
        <span class='kw'>return</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span> <span class='op'>==</span> <span class='int'>1</span>
        <span class='kw'>return</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:first</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
        <span class='kw'>return</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="predict-instance_method">
  
    #<strong>predict</strong>(inputs, array_output = true)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Predict outputs with a forward pass.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>inputs</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Array of input data</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>array_output</span>
      
      
        <span class='type'>(<tt>true</tt>, <tt>false</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>(Default: true) If true, convert the output to a numerical array. Otherwise
the output will be an NMatrix object</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>Network predictions.  For classification, this will return class labels
(otherwise use predict_proba).</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


133
134
135
136
137
138
139
140</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fast_forward/nn.rb', line 133</span>

<span class='kw'>def</span> <span class='id identifier rubyid_predict'>predict</span><span class='lparen'>(</span><span class='id identifier rubyid_inputs'>inputs</span><span class='comma'>,</span> <span class='id identifier rubyid_array_output'>array_output</span> <span class='op'>=</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_last_act'>last_act</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../FastForward.html" title="FastForward (module)">FastForward</a></span></span><span class='period'>.</span><span class='id identifier rubyid_rename_activation'>rename_activation</span><span class='lparen'>(</span><span class='ivar'>@layer_activations</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_last_act'>last_act</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>softmax</span><span class='tstring_end'>&quot;</span></span> <span class='op'>||</span> <span class='id identifier rubyid_last_act'>last_act</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sigmoid</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>return</span> <span class='id identifier rubyid_predict_class'>predict_class</span><span class='lparen'>(</span><span class='id identifier rubyid_inputs'>inputs</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
        <span class='kw'>return</span> <span class='id identifier rubyid_forward_pass'>forward_pass</span><span class='lparen'>(</span><span class='id identifier rubyid_inputs'>inputs</span><span class='comma'>,</span> <span class='id identifier rubyid_array_output'>array_output</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="predict_class-instance_method">
  
    #<strong>predict_class</strong>(inputs)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Predict class labels with a forward pass (supports multi-class and
multi-task).</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>inputs</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Array of input data</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>Network predictions</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fast_forward/nn.rb', line 94</span>

<span class='kw'>def</span> <span class='id identifier rubyid_predict_class'>predict_class</span><span class='lparen'>(</span><span class='id identifier rubyid_inputs'>inputs</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_n_inputs'>n_inputs</span> <span class='op'>=</span> <span class='id identifier rubyid_inputs'>inputs</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Numeric</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='int'>1</span> <span class='op'>:</span> <span class='id identifier rubyid_inputs'>inputs</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span>
    <span class='id identifier rubyid_probas'>probas</span> <span class='op'>=</span> <span class='id identifier rubyid_forward_pass'>forward_pass</span><span class='lparen'>(</span><span class='id identifier rubyid_inputs'>inputs</span><span class='comma'>,</span> <span class='id identifier rubyid_array_output'>array_output</span> <span class='op'>=</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_probas'>probas</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_probas'>probas</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_n_inputs'>n_inputs</span> <span class='op'>==</span> <span class='int'>1</span>
    <span class='id identifier rubyid_last_act'>last_act</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../FastForward.html" title="FastForward (module)">FastForward</a></span></span><span class='period'>.</span><span class='id identifier rubyid_rename_activation'>rename_activation</span><span class='lparen'>(</span><span class='ivar'>@layer_activations</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_last_act'>last_act</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>softmax</span><span class='tstring_end'>&quot;</span></span>
        <span class='comment'># multiclass
</span>        <span class='id identifier rubyid_classes'>classes</span> <span class='op'>=</span> <span class='id identifier rubyid_probas'>probas</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_class_p'>class_p</span><span class='op'>|</span>
            <span class='id identifier rubyid__'>_</span><span class='comma'>,</span><span class='id identifier rubyid_idx'>idx</span> <span class='op'>=</span> <span class='id identifier rubyid_class_p'>class_p</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span>
            <span class='id identifier rubyid_idx'>idx</span>
        <span class='kw'>end</span>
    
    <span class='kw'>elsif</span> <span class='id identifier rubyid_probas'>probas</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Numeric</span><span class='rparen'>)</span>
        <span class='comment'># 2-class
</span>        <span class='id identifier rubyid_classes'>classes</span> <span class='op'>=</span> <span class='id identifier rubyid_probas'>probas</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:round</span><span class='rparen'>)</span>

    <span class='kw'>else</span>
        <span class='comment'># multi-task
</span>        <span class='id identifier rubyid_classes'>classes</span> <span class='op'>=</span> <span class='id identifier rubyid_probas'>probas</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task_p'>task_p</span><span class='op'>|</span>
            <span class='id identifier rubyid_task_p'>task_p</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:round</span><span class='rparen'>)</span>
        <span class='kw'>end</span>

    <span class='kw'>end</span>

    <span class='id identifier rubyid_classes'>classes</span> <span class='op'>=</span> <span class='id identifier rubyid_classes'>classes</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span> <span class='kw'>if</span> <span class='id identifier rubyid_n_inputs'>n_inputs</span> <span class='op'>==</span> <span class='int'>1</span>

    <span class='kw'>return</span> <span class='id identifier rubyid_classes'>classes</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="predict_proba-instance_method">
  
    #<strong>predict_proba</strong>(inputs, array_output = true)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Same as forward_pass</p>
</div>
  </div>


<p>Predict class probabilities with a forward pass</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>inputs</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Array of input data</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>array_output</span>
      
      
        <span class='type'>(<tt>true</tt>, <tt>false</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>(Default: true) If true, convert the output to a numerical array. Otherwise
the output will be an NMatrix object</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>Network predictions</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


85
86
87</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fast_forward/nn.rb', line 85</span>

<span class='kw'>def</span> <span class='id identifier rubyid_predict_proba'>predict_proba</span><span class='lparen'>(</span><span class='id identifier rubyid_inputs'>inputs</span><span class='comma'>,</span> <span class='id identifier rubyid_array_output'>array_output</span> <span class='op'>=</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_forward_pass'>forward_pass</span><span class='lparen'>(</span><span class='id identifier rubyid_inputs'>inputs</span><span class='comma'>,</span> <span class='id identifier rubyid_array_output'>array_output</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Sat Oct 20 12:03:43 2018 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.16 (ruby-2.3.4).
</div>

    </div>
  </body>
</html>