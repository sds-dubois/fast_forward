<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: FastForward
  
    &mdash; Documentation by YARD 0.9.16
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "FastForward";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (F)</a> &raquo;
    
    
    <span class="title">FastForward</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: FastForward
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/fast_forward.rb<span class="defines">,<br />
  lib/fast_forward/nn.rb,<br /> lib/fast_forward/version.rb</span>
</dd>
  </dl>
  
</div>

<h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="FastForward/NN.html" title="FastForward::NN (class)">NN</a></span>
    
  
</p>

  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="DEFAULT_TOL-constant" class="">DEFAULT_TOL =
          <div class="docstring">
  <div class="discussion">
    
<p>Default tolerance for integrity check</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='float'>1e-8</span></pre></dd>
      
        <dt id="SUPPORTED_ACTIVATIONS-constant" class="">SUPPORTED_ACTIVATIONS =
          <div class="docstring">
  <div class="discussion">
    
<p>Supported activation functions</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>identity</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>relu</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sigmoid</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>tanh</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>softmax</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="VERSION-constant" class="">VERSION =
          
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0.1.0</span><span class='tstring_end'>&quot;</span></span></pre></dd>
      
    </dl>
  







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load-class_method" title="load (class method)">.<strong>load</strong>(data, tol: DEFAULT_TOL, exception_if_fail: true)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Loads neural network data into a NN object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_json-class_method" title="load_json (class method)">.<strong>load_json</strong>(data, tol: DEFAULT_TOL, exception_if_fail: true)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Loads neural network from JSON data/string into a NN object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_pmml-class_method" title="load_pmml (class method)">.<strong>load_pmml</strong>(data, sample_data: nil, tol: DEFAULT_TOL, exception_if_fail: true)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Loads neural network from PMML file into a NN object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_sample_data-class_method" title="load_sample_data (class method)">.<strong>load_sample_data</strong>(data)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Loads sample data.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="load-class_method">
  
    .<strong>load</strong>(data, tol: DEFAULT_TOL, exception_if_fail: true)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>data is supposed to have the following structure: data = { 	weights:
[weights_array_0, weights_array_1 , …], 	biases: [biases_array_0,
biases_array_1 , …], 	activations: [activation_fct_0, activation_fct_1, …],
	samples: (optional) { 	X: sample_inputs_array, 	y: sample_outputs_array 	}
}</p>
</div>
  </div>


<p>Loads neural network data into a NN object</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>data</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A hash containing all weights, biases and activation functions</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>tol</span>
      
      
        <span class='type'>(<tt>Numeric</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>(Default: 1e-8) The tolerance to check integrity of the imported model from
the provided samples</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>exception_if_fail</span>
      
      
        <span class='type'>(<tt>true</tt>, <tt>false</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>(Default: true) If true, raises an exception if integrity check doesn&#39;t
meet the required tolerance</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>The loaded neural network</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fast_forward.rb', line 35</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_load'>load</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='label'>tol:</span> <span class='const'><span class='object_link'><a href="#DEFAULT_TOL-constant" title="FastForward::DEFAULT_TOL (constant)">DEFAULT_TOL</a></span></span><span class='comma'>,</span> <span class='label'>exception_if_fail:</span> <span class='kw'>true</span><span class='rparen'>)</span>

	<span class='comment'># check inputs
</span>	<span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='symbol'>:weights</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='symbol'>:weights</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='op'>==</span> <span class='int'>0</span>
		<span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Missing weights data</span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>elsif</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='symbol'>:biases</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='symbol'>:biases</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='op'>==</span> <span class='int'>0</span>
		<span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Missing biases data</span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>elsif</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='symbol'>:activations</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='symbol'>:activations</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='op'>==</span> <span class='int'>0</span>
		<span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Missing activation functions</span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>elsif</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='symbol'>:weights</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>!=</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='symbol'>:biases</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
		<span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Array of weights and biases must have the same size</span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>elsif</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='symbol'>:weights</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>!=</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='symbol'>:activations</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
		<span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Array of weights and activations must have the same size</span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>elsif</span> <span class='op'>!</span><span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='symbol'>:activations</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_act'>act</span><span class='op'>|</span> <span class='const'><span class='object_link'><a href="#SUPPORTED_ACTIVATIONS-constant" title="FastForward::SUPPORTED_ACTIVATIONS (constant)">SUPPORTED_ACTIVATIONS</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_act'>act</span><span class='rparen'>)</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_all?'>all?</span>
		<span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Some activation functions are not supported</span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>end</span>


	<span class='id identifier rubyid_layer_sizes'>layer_sizes</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='symbol'>:weights</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:count</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='lbracket'>[</span><span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='symbol'>:weights</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='rbracket'>]</span>

	<span class='id identifier rubyid_nn'>nn</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="FastForward/NN.html" title="FastForward::NN (class)">NN</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="FastForward/NN.html#initialize-instance_method" title="FastForward::NN#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_layer_sizes'>layer_sizes</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='symbol'>:activations</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='symbol'>:weights</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='symbol'>:biases</span><span class='rbracket'>]</span><span class='rparen'>)</span>

	<span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='symbol'>:samples</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_tol'>tol</span> <span class='op'>&gt;=</span> <span class='int'>0</span>
		<span class='const'><span class='object_link'><a href="" title="FastForward (module)">FastForward</a></span></span><span class='period'>.</span><span class='id identifier rubyid_check_model_integrity'>check_model_integrity</span><span class='lparen'>(</span><span class='id identifier rubyid_nn'>nn</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='symbol'>:samples</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>tol:</span> <span class='id identifier rubyid_tol'>tol</span><span class='comma'>,</span> <span class='label'>exception_if_fail:</span> <span class='id identifier rubyid_exception_if_fail'>exception_if_fail</span><span class='comma'>,</span> <span class='label'>verbose:</span> <span class='kw'>true</span><span class='rparen'>)</span>
	<span class='kw'>end</span>

	<span class='kw'>return</span> <span class='id identifier rubyid_nn'>nn</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_json-class_method">
  
    .<strong>load_json</strong>(data, tol: DEFAULT_TOL, exception_if_fail: true)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>data is supposed to have the following structure: data = { 	“weights”: {
		“0”: weights_array_0, 		“1”: weights_array_1, 		… 	}, 	“biases”: 		“0”:
biases_array_0, 		“1”: biases_array_1, 		… 	}, 	“activations”: 		“0”:
activation_fct_0, 		“1”: activation_fct_1, 		… 	}, 	“samples”: (optional) {
	“X”: sample_inputs_array, 	“y”: sample_outputs_array 	} }</p>
</div>
  </div>


<p>Loads neural network from JSON data/string into a NN object</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>data</span>
      
      
        <span class='type'>(<tt>Hash</tt>, <tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A JSON string/object containing all weights, biases and activation
functions</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>tol</span>
      
      
        <span class='type'>(<tt>Numeric</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>(Default: 1e-8) The tolerance to check integrity of the imported model from
the provided samples</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>exception_if_fail</span>
      
      
        <span class='type'>(<tt>true</tt>, <tt>false</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>(Default: true) If true, raises an exception if integrity check doesn&#39;t
meet the required tolerance</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>The loaded neural network</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fast_forward.rb', line 94</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_load_json'>load_json</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='label'>tol:</span> <span class='const'><span class='object_link'><a href="#DEFAULT_TOL-constant" title="FastForward::DEFAULT_TOL (constant)">DEFAULT_TOL</a></span></span><span class='comma'>,</span> <span class='label'>exception_if_fail:</span> <span class='kw'>true</span><span class='rparen'>)</span>

	<span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'>JSON</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span>

	<span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>weights</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span> <span class='op'>!=</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>biases</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span>
		<span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Incoherent weights and biases data</span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>end</span>
	<span class='id identifier rubyid_n_layers'>n_layers</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>weights</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span>

	<span class='comment'># data[&quot;weights&quot;] &amp; data[&quot;biases&quot;] are dictionaries of `&quot;idx&quot;: array`
</span>	<span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='lbrace'>{</span>
		<span class='label'>weights:</span> <span class='id identifier rubyid_n_layers'>n_layers</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>weights</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rbracket'>]</span> <span class='rbrace'>}</span><span class='comma'>,</span>
		<span class='label'>biases:</span> <span class='id identifier rubyid_n_layers'>n_layers</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>biases</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rbracket'>]</span> <span class='rbrace'>}</span><span class='comma'>,</span>
		<span class='label'>activations:</span> <span class='id identifier rubyid_n_layers'>n_layers</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='const'><span class='object_link'><a href="" title="FastForward (module)">FastForward</a></span></span><span class='period'>.</span><span class='id identifier rubyid_rename_activation'>rename_activation</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>activations</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='rbrace'>}</span><span class='comma'>,</span>
		<span class='label'>samples:</span> <span class='const'><span class='object_link'><a href="" title="FastForward (module)">FastForward</a></span></span><span class='period'>.</span><span class='id identifier rubyid_load_sample_data'><span class='object_link'><a href="#load_sample_data-class_method" title="FastForward.load_sample_data (method)">load_sample_data</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span>
	<span class='rbrace'>}</span>

	<span class='kw'>return</span> <span class='const'><span class='object_link'><a href="" title="FastForward (module)">FastForward</a></span></span><span class='period'>.</span><span class='id identifier rubyid_load'><span class='object_link'><a href="#load-class_method" title="FastForward.load (method)">load</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_d'>d</span><span class='comma'>,</span> <span class='label'>tol:</span> <span class='id identifier rubyid_tol'>tol</span><span class='comma'>,</span> <span class='label'>exception_if_fail:</span> <span class='id identifier rubyid_exception_if_fail'>exception_if_fail</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_pmml-class_method">
  
    .<strong>load_pmml</strong>(data, sample_data: nil, tol: DEFAULT_TOL, exception_if_fail: true)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>sample_data is supposed to have the following structure: sample_data = {
	“samples”: { 	“X”: sample_inputs_array, 	“y”: sample_outputs_array 	} }</p>
</div>
  </div>


<p>Loads neural network from PMML file into a NN object</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>data</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>PMML file content</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>sample_data</span>
      
      
        <span class='type'>(<tt>Hash</tt>, <tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>(Default: nil) A JSON string/object containing sample data to check the
integrity of the loaded model</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>tol</span>
      
      
        <span class='type'>(<tt>Numeric</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>(Default: 1e-8) The tolerance to check integrity of the imported model from
the provided samples</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>exception_if_fail</span>
      
      
        <span class='type'>(<tt>true</tt>, <tt>false</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>(Default: true) If true, raises an exception if integrity check doesn&#39;t
meet the required tolerance</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>The loaded neural network</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fast_forward.rb', line 130</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_load_pmml'>load_pmml</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='label'>sample_data:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>tol:</span> <span class='const'><span class='object_link'><a href="#DEFAULT_TOL-constant" title="FastForward::DEFAULT_TOL (constant)">DEFAULT_TOL</a></span></span><span class='comma'>,</span> <span class='label'>exception_if_fail:</span> <span class='kw'>true</span><span class='rparen'>)</span>
	<span class='comment'># Load from PMML format: http://dmg.org/pmml/v4-3/NeuralNetwork.html
</span>	<span class='comment'># Note: does not support input transforms like NormContinuous
</span>	<span class='comment'># TODO: use element ids to check order
</span>	<span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'>Nokogiri</span><span class='op'>::</span><span class='const'>XML</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span>
	
	<span class='id identifier rubyid_all_weights'>all_weights</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
	<span class='id identifier rubyid_all_biases'>all_biases</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
	<span class='id identifier rubyid_all_activations'>all_activations</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
	
	<span class='id identifier rubyid_default_act'>default_act</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_at_css'>at_css</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>NeuralNetwork</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_attribute'>attribute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>activationFunction</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
	
	<span class='id identifier rubyid_layers'>layers</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_css'>css</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>NeuralLayer</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
	<span class='id identifier rubyid_layers'>layers</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_layer'>layer</span><span class='op'>|</span>
		<span class='id identifier rubyid_w'>w</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
		<span class='id identifier rubyid_b'>b</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
		<span class='id identifier rubyid_layer'>layer</span><span class='period'>.</span><span class='id identifier rubyid_css'>css</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Neuron</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_neuron'>neuron</span><span class='op'>|</span>
			<span class='id identifier rubyid_b'>b</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_neuron'>neuron</span><span class='period'>.</span><span class='id identifier rubyid_attribute'>attribute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bias</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span>
			<span class='id identifier rubyid_w'>w</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_neuron'>neuron</span><span class='period'>.</span><span class='id identifier rubyid_css'>css</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Con</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_wi'>wi</span><span class='op'>|</span> <span class='id identifier rubyid_wi'>wi</span><span class='period'>.</span><span class='id identifier rubyid_attribute'>attribute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>weight</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span> <span class='rbrace'>}</span>
		<span class='kw'>end</span>
		<span class='id identifier rubyid_all_weights'>all_weights</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_w'>w</span><span class='period'>.</span><span class='id identifier rubyid_transpose'>transpose</span>
		<span class='id identifier rubyid_all_biases'>all_biases</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_b'>b</span>

		<span class='comment'># in PMML format, softmax is a normalization and not an activation
</span>		<span class='id identifier rubyid_normalization'>normalization</span> <span class='op'>=</span> <span class='id identifier rubyid_layer'>layer</span><span class='period'>.</span><span class='id identifier rubyid_attribute'>attribute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>normalizationMethod</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_layer'>layer</span><span class='period'>.</span><span class='id identifier rubyid_attribute'>attribute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>normalizationMethod</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
		<span class='kw'>if</span> <span class='id identifier rubyid_normalization'>normalization</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>softmax</span><span class='tstring_end'>&quot;</span></span>
			<span class='id identifier rubyid_activation'>activation</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>softmax</span><span class='tstring_end'>&quot;</span></span> 
		<span class='kw'>else</span>
			<span class='id identifier rubyid_layer_activation'>layer_activation</span> <span class='op'>=</span> <span class='id identifier rubyid_layer'>layer</span><span class='period'>.</span><span class='id identifier rubyid_attribute'>attribute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>activationFunction</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
			<span class='id identifier rubyid_activation'>activation</span> <span class='op'>=</span> <span class='id identifier rubyid_layer_activation'>layer_activation</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>?</span> <span class='id identifier rubyid_default_act'>default_act</span> <span class='op'>:</span> <span class='id identifier rubyid_layer_activation'>layer_activation</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
		<span class='kw'>end</span>

		<span class='id identifier rubyid_all_activations'>all_activations</span> <span class='op'>&lt;&lt;</span> <span class='const'><span class='object_link'><a href="" title="FastForward (module)">FastForward</a></span></span><span class='period'>.</span><span class='id identifier rubyid_rename_activation'>rename_activation</span><span class='lparen'>(</span><span class='id identifier rubyid_activation'>activation</span><span class='rparen'>)</span>
	<span class='kw'>end</span>

	<span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='lbrace'>{</span>
		<span class='label'>weights:</span> <span class='id identifier rubyid_all_weights'>all_weights</span><span class='comma'>,</span>
		<span class='label'>biases:</span> <span class='id identifier rubyid_all_biases'>all_biases</span><span class='comma'>,</span>
		<span class='label'>activations:</span> <span class='id identifier rubyid_all_activations'>all_activations</span>
	<span class='rbrace'>}</span>
	<span class='id identifier rubyid_d'>d</span><span class='lbracket'>[</span><span class='symbol'>:samples</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="FastForward (module)">FastForward</a></span></span><span class='period'>.</span><span class='id identifier rubyid_load_sample_data'><span class='object_link'><a href="#load_sample_data-class_method" title="FastForward.load_sample_data (method)">load_sample_data</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_sample_data'>sample_data</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_sample_data'>sample_data</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

	<span class='kw'>return</span> <span class='const'><span class='object_link'><a href="" title="FastForward (module)">FastForward</a></span></span><span class='period'>.</span><span class='id identifier rubyid_load'><span class='object_link'><a href="#load-class_method" title="FastForward.load (method)">load</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_d'>d</span><span class='comma'>,</span> <span class='label'>tol:</span> <span class='id identifier rubyid_tol'>tol</span><span class='comma'>,</span> <span class='label'>exception_if_fail:</span> <span class='id identifier rubyid_exception_if_fail'>exception_if_fail</span><span class='rparen'>)</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_sample_data-class_method">
  
    .<strong>load_sample_data</strong>(data)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>data is supposed to have the following structure: data = { 	“samples”: {
	“X”: sample_inputs_array, 	“y”: sample_outputs_array 	} }</p>
</div>
  </div>


<p>Loads sample data</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>data</span>
      
      
        <span class='type'>(<tt>Hash</tt>, <tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A JSON string/object containing sample data to check the integrity of the
loaded model</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>The loaded data in a ruby hash</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


189
190
191
192
193
194
195
196</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fast_forward.rb', line 189</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_load_sample_data'>load_sample_data</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'>JSON</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='lbrace'>{</span>
		<span class='label'>X:</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>samples</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>X</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
		<span class='label'>y:</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>samples</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>y</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
	<span class='rbrace'>}</span>
	<span class='kw'>return</span> <span class='id identifier rubyid_d'>d</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Sat Oct 20 12:03:43 2018 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.16 (ruby-2.3.4).
</div>

    </div>
  </body>
</html>